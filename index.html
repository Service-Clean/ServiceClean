<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiceClean | Система управления клинингом</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Экран входа -->
        <div class="auth-screen" id="auth-screen">
            <div class="auth-card">
                <div class="auth-header">
                    <div class="logo">
                        <i class="fas fa-sparkles"></i>
                        <span>ServiceClean</span>
                    </div>
                    <h1>Добро пожаловать</h1>
                    <p>Войдите в систему управления клининговыми услугами</p>
                </div>
                
                <form id="login-form" class="auth-form">
                    <div class="form-group">
                        <label for="email">
                            <i class="fas fa-envelope"></i>
                            Email
                        </label>
                        <input type="email" id="email" placeholder="admin@serviceclean.ru" value="admin@serviceclean.ru" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">
                            <i class="fas fa-lock"></i>
                            Пароль
                        </label>
                        <input type="password" id="password" placeholder="••••••••" value="admin123" required>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i>
                            Войти в систему
                    </button>
                </form>

                <div class="auth-footer">
                    <p>Демо-доступ:</p>
                    <code>admin@serviceclean.ru / admin123</code>
                </div>
            </div>
        </div>

        <!-- Основное приложение -->
        <div class="main-app" id="main-app" style="display: none;">
            <!-- Боковое меню -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="logo">
                        <i class="fas fa-sparkles"></i>
                        <span>ServiceClean</span>
                    </div>
                </div>

                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-tab="dashboard">
                        <i class="fas fa-chart-pie"></i>
                        <span>Дашборд</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="employees">
                        <i class="fas fa-users"></i>
                        <span>Сотрудники</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="orders">
                        <i class="fas fa-clipboard-list"></i>
                        <span>Заказы</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Аналитика</span>
                    </a>
                </nav>

                <div class="sidebar-footer">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="user-details">
                            <span class="user-name" id="user-name">Администратор</span>
                            <span class="user-email" id="user-email">admin@serviceclean.ru</span>
                        </div>
                    </div>
                    <button class="btn btn-logout" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Выйти</span>
                    </button>
                </div>
            </aside>

            <!-- Основной контент -->
            <main class="content">
                <!-- Дашборд -->
                <section id="dashboard-tab" class="tab-content active">
                    <div class="content-header">
                        <h1>Дашборд</h1>
                        <p>Общая статистика системы</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: #e3f2fd; color: #1976d2">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">Сотрудников</span>
                                <span class="stat-value" id="stat-employees">0</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: #e8f5e9; color: #388e3c">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">Заказов</span>
                                <span class="stat-value" id="stat-orders">0</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: #fff3e0; color: #f57c00">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">В процессе</span>
                                <span class="stat-value" id="stat-in-progress">0</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: #fce4ec; color: #c2185b">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">Выполнено</span>
                                <span class="stat-value" id="stat-completed">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-line"></i> Динамика заказов</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="orders-chart"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-trophy"></i> Топ сотрудников</h3>
                            </div>
                            <div class="card-body" id="top-employees">
                                <!-- Данные будут вставлены через JS -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Сотрудники -->
                <section id="employees-tab" class="tab-content">
                    <div class="content-header">
                        <div>
                            <h1>Сотрудники</h1>
                            <p>Управление персоналом</p>
                        </div>
                        <button class="btn btn-primary" id="add-employee-btn">
                            <i class="fas fa-plus"></i>
                            Добавить сотрудника
                        </button>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Сотрудник</th>
                                    <th>Должность</th>
                                    <th>Контакты</th>
                                    <th>Дата найма</th>
                                    <th>Заказов</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="employees-list">
                                <tr>
                                    <td colspan="6" class="text-center">Загрузка...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Заказы -->
                <section id="orders-tab" class="tab-content">
                    <div class="content-header">
                        <div>
                            <h1>Заказы</h1>
                            <p>Управление заказами</p>
                        </div>
                        <button class="btn btn-primary" id="add-order-btn">
                            <i class="fas fa-plus"></i>
                            Создать заказ
                        </button>
                    </div>

                    <div class="filters">
                        <div class="filter-group">
                            <label>Статус:</label>
                            <select id="order-status-filter" class="filter-select">
                                <option value="all">Все статусы</option>
                                <option value="В процессе">В процессе</option>
                                <option value="Выполнен">Выполнен</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Сотрудник:</label>
                            <select id="order-employee-filter" class="filter-select">
                                <option value="all">Все сотрудники</option>
                            </select>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Клиент</th>
                                    <th>Услуга</th>
                                    <th>Сотрудник</th>
                                    <th>Дата</th>
                                    <th>Статус</th>
                                    <th>Сумма</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="orders-list">
                                <tr>
                                    <td colspan="7" class="text-center">Загрузка...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Аналитика -->
                <section id="reports-tab" class="tab-content">
                    <div class="content-header">
                        <div>
                            <h1>Аналитика</h1>
                            <p>Отчёты и статистика</p>
                        </div>
                        <div class="header-actions">
                            <button class="btn btn-secondary" id="generate-pdf-btn">
                                <i class="fas fa-file-pdf"></i>
                                Скачать отчёт
                            </button>
                            <button class="btn btn-secondary" id="show-qr-btn">
                                <i class="fas fa-qrcode"></i>
                                QR-код
                            </button>
                        </div>
                    </div>

                    <div class="analytics-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-pie"></i> Статусы заказов</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="status-chart"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-bar"></i> Заказы по сотрудникам</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="employees-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Модальное окно для QR -->
    <div class="modal" id="qr-modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h3>QR-код доступа</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body text-center">
                <div id="qrcode"></div>
                <p class="text-muted">Отсканируйте для быстрого доступа</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="download-qr-btn">
                    <i class="fas fa-download"></i>
                    Скачать
                </button>
            </div>
        </div>
    </div>

    <!-- Модальное окно для сотрудников -->
    <div class="modal" id="employee-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="employee-modal-title">Добавить сотрудника</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="employee-form">
                <div class="modal-body">
                    <input type="hidden" id="employee-id">
                    
                    <div class="form-group">
                        <label for="employee-name">ФИО *</label>
                        <input type="text" id="employee-name" required placeholder="Иванов Иван Иванович">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="employee-position">Должность *</label>
                            <input type="text" id="employee-position" required placeholder="Клинер">
                        </div>
                        <div class="form-group">
                            <label for="employee-phone">Телефон *</label>
                            <input type="tel" id="employee-phone" required placeholder="+7 (999) 999-99-99">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="employee-email">Email</label>
                            <input type="email" id="employee-email" placeholder="ivanov@mail.ru">
                        </div>
                        <div class="form-group">
                            <label for="employee-hire-date">Дата найма *</label>
                            <input type="date" id="employee-hire-date" required>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close-btn">Отмена</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно для заказов -->
    <div class="modal" id="order-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="order-modal-title">Создать заказ</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="order-form">
                <div class="modal-body">
                    <input type="hidden" id="order-id">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="order-client">Клиент *</label>
                            <input type="text" id="order-client" required placeholder="ООО Компания">
                        </div>
                        <div class="form-group">
                            <label for="order-service">Услуга *</label>
                            <input type="text" id="order-service" required placeholder="Генеральная уборка">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="order-employee">Сотрудник *</label>
                            <select id="order-employee" required>
                                <option value="">Выберите сотрудника</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="order-date">Дата и время *</label>
                            <input type="datetime-local" id="order-date" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="order-status">Статус *</label>
                            <select id="order-status" required>
                                <option value="В процессе">В процессе</option>
                                <option value="Выполнен">Выполнен</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="order-amount">Сумма *</label>
                            <input type="number" id="order-amount" required min="0" step="100" placeholder="5000">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close-btn">Отмена</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
