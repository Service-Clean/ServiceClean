<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ServiceClean ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–ª–∏–Ω–∏–Ω–≥–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏</title>
  
  <meta property="og:title" content="ServiceClean ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–Ω–∏–Ω–≥–æ–≤—ã–º –±–∏–∑–Ω–µ—Å–æ–º">
  <meta property="og:description" content="–£—á—ë—Ç –∑–∞–∫–∞–∑–æ–≤, –∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤">
  <meta property="og:type" content="website">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f4f7fc;
      color: #1e293b;
      line-height: 1.6;
      padding: 24px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 36px;
      box-shadow: 0 20px 40px -15px rgba(0,0,0,0.1);
      padding: 32px;
    }

    h1 {
      font-size: 2.4em;
      font-weight: 700;
      color: #0b3b5c;
      border-bottom: 4px solid #0b3b5c;
      padding-bottom: 18px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    h1 span {
      background: #0b3b5c;
      color: white;
      font-size: 0.4em;
      padding: 6px 20px;
      border-radius: 50px;
      font-weight: 600;
    }

    h2 {
      color: #0b3b5c;
      margin-bottom: 20px;
      font-size: 1.6em;
      font-weight: 600;
    }

    .user-info {
      background: #f1f5f9;
      padding: 16px 28px;
      border-radius: 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    button {
      background: #0b3b5c;
      color: white;
      padding: 12px 28px;
      border: none;
      border-radius: 40px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: #1e4f6e;
      transform: translateY(-2px);
      box-shadow: 0 10px 20px -5px rgba(11,59,92,0.2);
    }

    .btn-outline {
      background: white;
      color: #0b3b5c;
      border: 2px solid #0b3b5c;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: #f8fafc;
      padding: 24px;
      border-radius: 24px;
      text-align: center;
    }

    .stat-value {
      font-size: 2.2em;
      font-weight: 800;
      color: #0b3b5c;
      margin-bottom: 8px;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 28px;
      background: #f1f5f9;
      border-radius: 40px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.2s;
    }

    .tab.active {
      background: #0b3b5c;
      color: white;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    .data-table th {
      background: #f1f5f9;
      color: #0b3b5c;
      font-weight: 600;
      padding: 14px;
      text-align: left;
    }

    .data-table td {
      padding: 14px;
      border-bottom: 1px solid #e2e8f0;
    }

    .badge {
      padding: 4px 12px;
      border-radius: 40px;
      font-size: 0.85em;
      font-weight: 600;
    }

    .badge-success { background: #dcfce7; color: #166534; }
    .badge-warning { background: #fff3cd; color: #856404; }
    .badge-info { background: #dbeafe; color: #1e40af; }

    .qr-section {
      margin: 30px 0;
      text-align: center;
    }

    .qr-toggle {
      background: white;
      color: #0b3b5c;
      border: 2px solid #0b3b5c;
      padding: 12px 32px;
    }

    .qr-container {
      display: none;
      margin-top: 20px;
      padding: 20px;
      border: 2px solid #0b3b5c;
      border-radius: 28px;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }

    .qr-container.show {
      display: block;
    }

    .qr-container img {
      width: 200px;
      height: 200px;
    }

    .footer {
      margin-top: 40px;
      padding: 32px;
      background: #f8fafc;
      border-radius: 28px;
      text-align: center;
      color: #475569;
    }

    @media (max-width: 700px) {
      .stats-grid {
        grid-template-columns: 1fr 1fr;
      }
      
      .data-table {
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>
      üßº ServiceClean 
      <span>–ò–° –¥–ª—è –∫–ª–∏–Ω–∏–Ω–≥–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏</span>
    </h1>

    <div class="user-info">
      <span id="userStatus">üë§ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
      <button id="authButton" class="btn-outline">üö™ –í—ã–π—Ç–∏</button>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" id="totalOrders">24</div>
        <div>–ó–∞–∫–∞–∑–æ–≤ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalRevenue">487 500</div>
        <div>–í—ã—Ä—É—á–∫–∞, ‚ÇΩ</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="avgCheck">20 312</div>
        <div>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫, ‚ÇΩ</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="profitMargin">35%</div>
        <div>–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å</div>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" onclick="showTab('orders')">üìã –ó–∞–∫–∞–∑—ã</div>
      <div class="tab" onclick="showTab('clients')">üë• –ö–ª–∏–µ–Ω—Ç—ã</div>
      <div class="tab" onclick="showTab('employees')">üßë‚Äçüîß –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</div>
      <div class="tab" onclick="showTab('services')">üß¥ –£—Å–ª—É–≥–∏</div>
      <div class="tab" onclick="showTab('reports')">üìä –û—Ç—á—ë—Ç—ã</div>
    </div>

    <div id="orders-tab" class="tab-content" style="display: block;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>üìã –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤</h2>
        <button onclick="showOrderForm()">‚ûï –ù–æ–≤—ã–π –∑–∞–∫–∞–∑</button>
      </div>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>‚Ññ</th>
            <th>–ö–ª–∏–µ–Ω—Ç</th>
            <th>–£—Å–ª—É–≥–∞</th>
            <th>–î–∞—Ç–∞</th>
            <th>–°—É–º–º–∞</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
          </tr>
        </thead>
        <tbody id="orders-list">
          <tr><td colspan="7" style="text-align: center;">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
        </tbody>
      </table>
    </div>

    <div id="clients-tab" class="tab-content" style="display: none;">
      <h2>üë• –ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>–§–ò–û</th>
            <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
            <th>Email</th>
            <th>–ê–¥—Ä–µ—Å</th>
            <th>–ó–∞–∫–∞–∑–æ–≤</th>
          </tr>
        </thead>
        <tbody id="clients-list">
          <tr><td colspan="6" style="text-align: center;">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
        </tbody>
      </table>
    </div>

    <div class="qr-section">
      <button id="qrToggleBtn" class="qr-toggle">üì± –ü–æ–∫–∞–∑–∞—Ç—å QR-–∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞</button>
      <div id="qrContainer" class="qr-container">
        <img src="https://quickchart.io/qr?text=https://[–ª–æ–≥–∏–Ω].github.io/ServiceClean/&size=200&margin=0&ecLevel=H&color=0b3b5c" alt="QR-–∫–æ–¥">
        <p style="margin-top: 16px;">üßº ServiceClean</p>
        <p style="font-size: 12px;">https://[–ª–æ–≥–∏–Ω].github.io/ServiceClean/</p>
      </div>
    </div>

    <div class="footer">
      <p>¬© 2026 –û–û–û ¬´–°–µ—Ä–≤–∏—Å–ö–ª–∏–Ω¬ª (ServiceClean) ¬∑ –î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ö–æ–ª–µ—Å–Ω–∏—á–µ–Ω–∫–æ –ê., –ö–æ–±–µ–Ω—è–∫ –ê.</p>
      <p style="margin-top: 8px;">–ì—Ä—É–ø–ø–∞ –ò–°-22 ¬∑ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å 09.02.07 –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = 'https://pyojgyasaccwrcdogexx.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_db9nx0GejLB8Cw7XNB3ACg_FmTeP-WX';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let currentUser = null;

    async function checkUser() {
      const { data: { user } } = await supabase.auth.getUser();
      currentUser = user;
      document.getElementById('userStatus').innerHTML = user 
        ? `üë§ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: ${user.email || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}`
        : 'üë§ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: –ì–æ—Å—Ç—å (–¥–µ–º–æ-—Ä–µ–∂–∏–º)';
    }

    async function loadOrders() {
      const { data, error } = await supabase
        .from('orders')
        .select('*')
        .order('created_at', { ascending: false })
        .limit(10);
      
      if (error) {
        console.error(error);
        return;
      }

      const tbody = document.getElementById('orders-list');
      if (!data || data.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>';
        return;
      }

      tbody.innerHTML = data.map(order => `
        <tr>
          <td>${order.id}</td>
          <td>–ö–ª–∏–µ–Ω—Ç #${order.client_id}</td>
          <td>${order.service_ids?.length || 0} —É—Å–ª—É–≥</td>
          <td>${order.order_date}</td>
          <td>${order.total_price?.toLocaleString() || 0} ‚ÇΩ</td>
          <td><span class="badge badge-info">${order.status}</span></td>
          <td>–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${order.employee_id || '‚Äî'}</td>
        </tr>
      `).join('');
    }

    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
      document.getElementById(`${tabName}-tab`).style.display = 'block';
      
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
    }

    document.getElementById('qrToggleBtn').addEventListener('click', function() {
      document.getElementById('qrContainer').classList.toggle('show');
    });

    checkUser();
    loadOrders();
  </script>
</body>
</html>
